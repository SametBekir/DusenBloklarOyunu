@page
@model DusenBloklarOyunu.Pages.IndexModel
@{
    ViewData["Title"] = "Düşen Elmalar";
}

<h1>@ViewData["Title"]</h1>

@if (TempData["Message"] != null)
{
        <p style="color: green;">@TempData["Message"]</p>
}

@if (TempData["Error"] != null)
{
        <p style="color: red;">@TempData["Error"]</p>
}

<!-- Oyun Alanı -->
<div id="game-area">
    <div id="player"></div>
</div>

<div id="game-controls">
    <button id="start-button">Oyunu Başlat</button>
</div>

<div id="score-board">
    <p>Puan: <span id="score">0</span></p>
    <p>Seviye: <span id="level">1</span></p>
</div>

<!-- Veri Kaydetme Formu -->
<h3>Oyuncu Verisi Kaydet</h3>
<form method="post" asp-page-handler="SaveData">
    <input type="text" name="playerName" placeholder="Oyuncu Adı" required />
    <input type="number" name="score" placeholder="Puan" required />
    <input type="number" name="level" placeholder="Seviye" required />
    <button type="submit">Veriyi Kaydet</button>
</form>

<!-- Kaydedilen Verileri Göster -->
<h3>Kaydedilen Veriler:</h3>
@if (Model.GameData != null && Model.GameData.Length > 0)
{
        <ul>
        @foreach (var line in Model.GameData)
        {
                    <li>@line</li>
        }
        </ul>
}
else
{
        <p>Henüz kaydedilmiş bir veri yok.</p>
}

<script>
    let playerName = "";
    let score = 0;
    let level = 1;
    let gameInterval;
    let isGameRunning = false;

    function startGame() {
        if (isGameRunning) return;

        isGameRunning = true;
        score = 0;
        level = 1;
        document.getElementById("start-button").style.display = "none";

        // Oyun başlama işlemleri
        gameInterval = setInterval(updateGame, 30);
    }

    function updateGame() {
        if (!isGameRunning) return;

        // Puan ve seviye güncelleme
        if (score >= 50 * level) {
            level++;
        }
        document.getElementById("score").innerText = score;
        document.getElementById("level").innerText = level;
    }

    document.getElementById("start-button").addEventListener("click", startGame);
</script>

<style>
    body {
        background-image: url('/images/Adsız tasarım.png');
        background-size: cover;
        margin: 0;
        height: 100vh;
    }

    #game-area {
        position: relative;
        width: 500px;
        height: 600px;
        border: 2px solid black;
        overflow: hidden;
        background-color: brown;
    }

    #player {
        position: absolute;
        bottom: 10px;
        left: 50%;
        width: 90px;
        height: 90px;
        background-image: url('/images/projesepet.png');
        background-size: cover;
        transform: translateX(-50%);
    }

    #score-board, form {
        margin-top: 20px;
    }
</style>